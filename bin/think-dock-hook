#!/bin/bash
# Copyright Â© 2012-2013 Martin Ueding <dev@martin-ueding.de>
# Licensed under The GNU Public License Version 2 (or later)

TEXTDOMAIN=think-rotate

set -e
set -u

# Find the user who is currently logged in on the primary screen.
user="$(who -u | grep -E '\(:0(\.0)?\)' | head -n 1 | awk '{print $1}')"

logger -t think-dock -- "Using user $user."

case "$1" in
    on)
        setto=on
        ;;
    off)
        setto=off
        ;;
esac

su -c "DISPLAY=:0.0 kdialog=false /usr/bin/think-dock $setto" --login "$user" &

disown
